{% extends 'base.html' %}
{% load static %}
{% block title %}Dashboard - The Pink Book{% endblock %}

{% block content %}
       <div class="container">
    <!-- Profile Card -->
    <div class="card">
        {% if user.profile_picture %}
        <div class="profile-picture">
            <img src="{{ user.profile_picture.url }}" alt="Profile face">
        </div>
        {% else %}
        <div class="profile-picture">
            <img src="{% static 'journal/media/default-profile-pic.jpg' %}" alt="Profile">
        </div>
        {% endif %}
        <h2>Welcome, {{ user.sissy_name }}!</h2>
        <!-- Edit Profile and Settings Links -->
        <div class="profile-links">
            <a href="{% url 'journal:profile_update' %}" class="edit-link">Edit Profile</a>
            <span>|</span>
            <a href="{% url 'journal:profile_settings' %}" class="settings-link">Settings</a>
        </div>
    </div>
    <!-- ... rest of the template ... -->
</div>
    </div>

    <!-- Entries Card -->
    <div class="card">
        <h2>Your Recent Entries</h2>
        <ul class="entry-list">
            {% for entry in entries %}
            <li>
                <a href="{% url 'journal:entry_detail' entry.id %}" class="pink-link">{{ entry.title }}</a>
                <small>Created on {{ entry.timestamp|date:"d M Y" }}</small>
            </li>
            {% empty %}
            <p>You haven't added any recent entries. Start journaling now!</p>
            {% endfor %}
        </ul>
        <a href="{% url 'journal:new_entry' %}" class="btn">New Entry</a>
    </div>

    <!-- To-Do List Card -->
    <div class="card">
        <h2>Your To-Do List</h2>
        <ul class="todo-list">
            {% for todo in todos %}
            <li>
                <input type="checkbox" data-id="{{ todo.id }}" class="todo-checkbox">
                <span>{{ todo.task }}</span>
                <small>Due on {{ todo.due_date|date:"d M Y" }}</small>
            </li>
            {% empty %}
            <p>No tasks pending. You're all caught up!</p>
            {% endfor %}
        </ul>
        <a href="{% url 'journal:create_todo' %}" class="btn">Add New Task</a>
    </div>

    <!-- Habits Tracker Card -->
    <div class="card">
        <h2>Your Habits</h2>
        <ul class="habit-list">
            {% for habit in habits %}
            <li>
                <span>{{ habit.name }}</span>
                <button onclick="incrementHabitCounter({{ habit.id }})" class="btn btn-small">Mark as Done</button>
                <small>Streak: {{ habit.streak }}</small>
            </li>
            {% empty %}
            <p>You haven't added any habits yet. Start building new habits today!</p>
            {% endfor %}
        </ul>
        <a href="{% url 'journal:habit_form' %}" class="btn">Add New Habit</a>
    </div>

    <!-- Insights Card -->
    <div class="card">
        <h2>Your Insights</h2>
        <section class="insights-section">
            {% if entries %}
            <ul>
                <li><strong>General Feels:</strong>
                    {% if avg_polarity > 0 %} Happy feels Yayyyy!
                    {% elif avg_polarity == 0 %} Got the Meh feels....
                    {% elif avg_polarity < 0 %} OMG babe, I'm literally crying rivers ðŸ˜­
                    {% endif %}
                </li>
                <li><strong>Girly Gauge:</strong>
                    {% if avg_subjectivity > 0.51 %} Oh, so girly, Gurl!
                    {% elif avg_subjectivity == 0.5 %} You're girling up honey!
                    {% elif avg_subjectivity < 0.49 %} Boy alert, write with your heart not your head
                    {% endif %}
                </li>
                <li><strong>Most Talked About:</strong>
                    {% for keyword, count in frequent_keywords %}
                    {{ keyword }} ({{ count }}),
                    {% endfor %}
                </li>
                <li><strong>Most Common Tag:</strong> {{ common_tags.0.0 }}</li>
                <li><strong>Most Common Emotion:</strong> {{ most_common_emotions.0.0 }}</li>
                <li><strong>Average Word Count:</strong> {{ average_word_count }}</li>
                <li><strong>Consistent Journaling:</strong> You've been journaling for {{ streak }} consecutive days!</li>
                {% if streak >= 10 %}
                <li>Impressive dedication, {{ profile.sissy_name }}, your consistency is commendable. ðŸš€</li>
                {% elif streak >= 5 %}
                <li>You're building a strong habit. Keep the momentum alive! ðŸ”¥</li>
                {% endif %}
                <li><strong>Peak Journaling Hour:</strong> You're most active around {{ most_active_hour }}:00. Whether it's morning reflections or evening recaps, keep pouring your thoughts!</li>
            </ul>
            {% else %}
            <p>No insights yet, darling. Why not write a new journal entry?</p>
            {% endif %}
        </section>
    </div>

    <!-- Quote of the Day Card -->
    <div class="card">
        <h2>Quote of the Day</h2>
        <p>"{{ quote_of_the_day }}"</p>
    </div>
</div>
{% endblock %}
